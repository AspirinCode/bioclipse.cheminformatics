From 384682c2f7e744924d627f66919b991f8b486c58 Mon Sep 17 00:00:00 2001
From: goglepox <goglepox@fcb5ba71-d80d-0410-8237-ba3920747fcc>
Date: Fri, 26 Jun 2009 09:58:57 +0000
Subject: [PATCH] Do not relay any rightclick.

Solves bug #1361

git-svn-id: https://bioclipse.svn.sourceforge.net/svnroot/bioclipse/bioclipse2/trunk@11510 fcb5ba71-d80d-0410-8237-ba3920747fcc
---
 .../cdk/controller/AddBondDragModule.java          |    8 +++++---
 1 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/cdk-externals/trunk/org.openscience.cdk.control/src/org/openscience/cdk/controller/AddBondDragModule.java b/cdk-externals/trunk/org.openscience.cdk.control/src/org/openscience/cdk/controller/AddBondDragModule.java
index 297470f..3836802 100644
--- a/cdk-externals/trunk/org.openscience.cdk.control/src/org/openscience/cdk/controller/AddBondDragModule.java
+++ b/cdk-externals/trunk/org.openscience.cdk.control/src/org/openscience/cdk/controller/AddBondDragModule.java
@@ -146,12 +146,14 @@ public class AddBondDragModule extends ControllerModuleAdapter {
         if(merge!=null) {
                 chemModelRelay.addBond( newAtom , merge );
         } else {
-            if(start.distance( worldCoord )<getHighlightDistance()) {
+            if( start!=null && start.distance( worldCoord )<getHighlightDistance()) {
                 if(!newSource)
                     chemModelRelay.addAtom( "C", newAtom );
             }else {
-                IAtom atom = chemModelRelay.addAtom( "C", dest );
-                chemModelRelay.addBond( newAtom, atom );
+                if(dest != null) {
+                    IAtom atom = chemModelRelay.addAtom( "C", dest );
+                    chemModelRelay.addBond( newAtom, atom );
+                }
             }
         }
     }
-- 
1.6.0.4


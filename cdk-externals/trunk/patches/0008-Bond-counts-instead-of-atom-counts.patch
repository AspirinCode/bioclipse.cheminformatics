From 8d355ba9e0eecef9c13f081a3dab287c98ea3bf2 Mon Sep 17 00:00:00 2001
From: gilleain <gilleain@fcb5ba71-d80d-0410-8237-ba3920747fcc>
Date: Wed, 13 May 2009 12:08:57 +0000
Subject: [PATCH] Bond counts instead of atom counts.

git-svn-id: https://bioclipse.svn.sourceforge.net/svnroot/bioclipse/bioclipse2/trunk@10301 fcb5ba71-d80d-0410-8237-ba3920747fcc
---
 .../cdk/charges/GasteigerPEPEPartialCharges.java   |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/cdk-externals/trunk/org.openscience.cdk.charges/src/org/openscience/cdk/charges/GasteigerPEPEPartialCharges.java b/cdk-externals/trunk/org.openscience.cdk.charges/src/org/openscience/cdk/charges/GasteigerPEPEPartialCharges.java
index 336eb5d..2a2bc80 100644
--- a/cdk-externals/trunk/org.openscience.cdk.charges/src/org/openscience/cdk/charges/GasteigerPEPEPartialCharges.java
+++ b/cdk-externals/trunk/org.openscience.cdk.charges/src/org/openscience/cdk/charges/GasteigerPEPEPartialCharges.java
@@ -148,7 +148,7 @@ public class GasteigerPEPEPartialCharges implements IChargeCalculator {
 
         // we save the aromaticity flags for the input molecule so that
         // we can add them back before we return
-        boolean[] oldBondAromaticity = new boolean[ac.getAtomCount()];
+        boolean[] oldBondAromaticity = new boolean[ac.getBondCount()];
         boolean[] oldAtomAromaticity = new boolean[ac.getAtomCount()];
         for (int i = 0; i < ac.getAtomCount(); i++) oldAtomAromaticity[i] = ac.getAtom(i).getFlag(CDKConstants.ISAROMATIC);
         for (int i = 0; i < ac.getBondCount(); i++) oldBondAromaticity[i] = ac.getBond(i).getFlag(CDKConstants.ISAROMATIC);
-- 
1.6.0.4


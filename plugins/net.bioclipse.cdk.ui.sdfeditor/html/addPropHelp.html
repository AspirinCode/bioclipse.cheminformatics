<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<title>Bioclipse Help</title>
	<link rel="stylesheet" href="../../PRODUCT_PLUGIN/narrow_book.css" type="text/css">
</head>

<body>
<h1>Importing properties to a SD-file</h1>
<br>
<br>
<h2>Introduction</h2>
Sometimes you have a file with some properties that you want to add to molecules in a SD-file. In Bioclipse this can be done by selecting both the SD-file and the file with the properties in Bioclipse navigator field, then right-clicking on either of them and choose &ldquo;Add properties&rdquo; in the popup-menu that appears. If you only have one of the files in Bioclipse workspace, i.e. is visibly in the navigator field; don't worry, just right click on it and choose &ldquo;Add properties&rdquo; from the popup-menu. You can add the other file later when the wizard has opened. Observe that even though it is possible to select more than two files, this wizard only add <i>one</i> file with properties to <i>one</i> SD-file.
<br><br>
<h2>The input data</h2>
Before describing how this wizard works, it is worth to mention a few words about the formart of the file that contains the data that is to be added to the SD-file. The wizard is based on the assumption that all properties values for a specific molecule are on the same row and that theres one row for each molecule. It also assumes that name of the properties, if there are any, are on the first row of the file.<br>
The rest of this section is for the those that are more interested in how the file is suposed to be formatted, and/or having trouble with getting there files to work properly. The wizard surports the most common used ways to separate data in a text-file, i.e when the values are separated with a comma, a tab or just blank space(s). The file itself supposed to be a simpel text file (that kind of file that you work with in e.g. Notepad in Windows). As noted above the data for a specific molecule should be on the same row with the values separated with a comma, a tab-sign or one or several blank spaces. If it contains the names of the properties then they are suposed to be on the first (top) row of the file. Also observe that if the file used has e.g. the names of the molecules as row-header and the names of the properties as column-header, then the first combo-box containing the properties name will be empty, e.g. when adding data from the QSAR-plugin as in the example below.
<br><br>
<h2>Choosing the files to merge</h2>
<img src="images/pic1.jpg" width="350" align=right>
When open the wizard as described above, the two files will appear in the two top fields of the wizard (see the figure to the right). If only one file was selected then it appears in the corresponding field, and the other can be chosen by clicking on the button with the text &ldquo;Browse...&rdquo; just to the right of the field. Doing so will open a open-file-dialog where you can search for the file you want. This button can of cause also be used to choose a different file.<br>
When a data file has been selected, then the wizard will read it. The result can be seen in the square below the file-settings. In the row with the label &ldquo;Name&rdquo; infront of it are the names if the different properties, or to be exact; the top row of the data file. Let's simply call it &ldquo;the name-row&rdquo; from now on. Below that are the values from the next five rows in the data file, in the rows with the label &ldquo;Values&rdquo; infront. If all seams ok, it is just to press the ok-button at the bottom of the wizard and the properties will be added to the molecules in SD-file.
<br>The result is saved in a new file in the same director as the file you selected when you opened the wizard, and it will have almost the same name as the old SD-file. The difference is that the result file will end with &ldquo;_new&rdquo;. I.e. if your SD-file is called &ldquo;My_molecules.sdf&rdquo;, then the resulting file will have the name &ldquo;My_molecules_new.sdf&rdquo;. 
<br> Note that if any property has the same name as a property in the SD-file the value of that property will be replaced with the value from the data file. Also note that the names are case sensitive, e.g. the name &ldquo;ID&rdquo; is not the same as &ldquo;id&rdquo;.
<br><br>
<h2>Change the name of a property</h2>
Some times you might want to change the name of one or several properties before adding them, the easiest way to do this is to just click in the field with the name of that property and write the new name on it. Note that you can not link properties that you have namned this way (what it means to link properties is described in the section &ldquo;The data connection box&rdquo; below).
<br><br>
<h2>Include a property</h2>
If the data file by some reason contains a property that you do not want to add to the molecules in the SD-file, then you can exclude it. This is done by unchecking the check-box beneath the column of that property, it's in the row with the label &ldquo;Include&rdquo; infront, just at the botom of the square showing the properties.
<br><br>
<h2>No properties name in the data file</h2>
<img src="images/pic2.jpg" width="350" align=right>
If the data file lacks the property names, i.e. the first row in the file contains property values as well. Then the name-row  (the one with the label &ldquo;Names&rdquo; infront) will contain the values from the first row of the data file. But this is probably not what you wanted, to solve this just select the option &ldquo;Data file does not includes properties name&rdquo; in the box called &ldquo;Properties name&rdquo; just below the square with the properties value mention above. Then the values in the name-row will jump down to the top row of the rows with the name &ldquo;Values&rdquo; in front, and in the name-row there will appear a drop-down-menu for each property. See the picture to the right. Now you can either just write the name of the property in it or, if you have selected a SD-file as well, you can choose one of the property names used by the SD-file. Note that if doing so the value of that property will be replaced by the value from the data file. Also note that when you add a property name by writing the name in the box you can not link it, just as when you rename a property.
<br><br>
<h2>The data connection box</h2>
There is one box with radio-buttons that has not been mention yet. It's the one at the bottom called &ldquo;Data connection&rdquo;, with this you can control how the data is added to the SD-file. The first, and default, option states &ldquo;The order of the data file is as in the SD-file&rdquo;. What this mean is that the first row of properties in the data file will be added to the first molecule in the SD-file, the second row to the second molecule, etc.<br>
With the other option in that box you can chose to link one of the properties in the data file to another in the SD-file. This means that if the value of the linked properties are the same, then the other properties of that row in the data file will be added to that molecule. Which properties that are to be linked is chosen in respective combo-box on the same line as the radio button for this option.<br>
This is usefully if you for example have a SD-file with many molecules, but there are only some of them that you want to add new properties to and/or change the values of one or several existing properties. Let's e.g. say that all molecules in the SD-file has a property called &ldquo;IDNUMBER&rdquo;, that represent a id-number for the molecules. Then if you have the id-numbers of the molecule you want to change as a property in your data file (along with the other properties), let's say that you call that property &ldquo;mol_id&rdquo;. Now it's easy manipulate only the molecules that you want to manipulate: Select the last alternative in the &ldquo;Data connection box&rdquo; and choose &ldquo;mol_id&rdquo; in the left combo-box and &ldquo;IDNUMBER&rdquo; in the right. <i>Note that when using this option it will take much longer time to add the properties to the molecules, because the data file will have to be read several times.</i> 
<br><br>
<h2>A simple example</h2>
If you want to repeat this example you have to have the QSAR-plugin and Sample data installed. How to install them as well as the exact steps in QSAR is out of the scope for this example, so for those part see the help pages for installing plugins and the QSAR-help pages and cheat sheets.<br>
First we start with creating a new QSAR-project and then we calculate some properties for the a SD-file called Fragments2.sdf from the sample data folder. When this is done there is a file called dataset.csv, it contains the newly calculated properties. Now, what we are going to do in this example is to add those properties to the molecules that was used for calculating them.<br><br><img src="images/example.png" width="350" align=right>
Now right click on the SD-file that you used for the calculations and choose "Add Properties from file..." (it's the second from the bottom in the pop-up menu). This wizard appears. Now will we tell the wizard witch file that contains the properties. To do this click on the bottom-most of the two buttons with the label "Browse..."(marked with "1" in the figure to the right), this will open a dilog for opening files.<br>
Open the folder of the new QSAR-project and choose the file named dataset.csv and click "Open". Now the wizard will read in the data file and show the result in the box in the middle. The properties name are in the row with the label "Name" in front (2) and below there are columns with the values from the first five rows in the data file(3). Notice the first column don't have any name, this is because QSAR don't give that column any name (if you open dataset.csv in the matrix editor you will see that the first row actually are row headers and the properties name are column heders, and that is why it dont get ant name). Also notice that the last column named "RESPONSE" don't contain any values, just "NaN". To tell the wizard to not include those two columns, just uncheck the check-boxes beneath those columns (4), and any other column that you for some reason don't want to be included. The wizard-dialog will now look simular to the figure to the right.<br>
To add to the SD-file just click on the Finish-button in the bottom of the dialog (5), and a new SD-file is created in the same folder as the old.

</body>
</html>